<!DOCTYPE html>
<html>
<title>BIMsurfer V2 - Demo index</title>
<head>
	<script type="text/javascript" src="https://thisisanexperimentalserver.com/apps/bimserverjavascriptapi/js/bimserverapiwebsocket.js"></script>
	<script type="text/javascript" src="https://thisisanexperimentalserver.com/apps/bimserverjavascriptapi/js/bimserverclient.js"></script>
	<script type="text/javascript" src="https://thisisanexperimentalserver.com/apps/bimserverjavascriptapi/js/bimserverapipromise.js"></script>
	<script type="text/javascript" src="https://thisisanexperimentalserver.com/apps/bimserverjavascriptapi/js/ifc2x3tc1.js"></script>
	<script type="text/javascript" src="https://thisisanexperimentalserver.com/apps/bimserverjavascriptapi/js/ifc4.js"></script>
	<script type="text/javascript" src="https://thisisanexperimentalserver.com/apps/bimserverjavascriptapi/js/model.js"></script>
	<script type="text/javascript" src="https://thisisanexperimentalserver.com/apps/bimserverjavascriptapi/js/translations_en.js"></script>
</head>
<body>
<div id="status"></div>
<ul id="projects">
</ul>
<script>
document.addEventListener("DOMContentLoaded", function(event) { 
	var client = new BimServerClient("https://thisisanexperimentalserver.com");
	var status = document.getElementById("status");
	status.innerHTML = "Initializing BIMserver API...";
	client.init(function(){
		status.textContent = "Logging in...";
		client.login("bimsurfer@logic-labs.nl", "bimsurfer", function(){
			status.textContent = "Getting all projects...";
			client.call("ServiceInterface", "getAllProjects", {
				onlyTopLevel: true,
				onlyActive: true
			}, function(projects){
				projects.forEach(function(project){
					if (project.lastRevisionId != -1) {
						var li = document.createElement("li");
						var a = document.createElement("a");
						li.appendChild(a);
						a.textContent = project.name;
						a.setAttribute("href", "example_BIMServer.html?poid=" + project.oid + "&roid=" + project.lastRevisionId);
						document.getElementById("projects").appendChild(li);
					}
				});
				status.textContent = "All projects loaded";
			});
		});
	});
});
</script>
</body>
</html>