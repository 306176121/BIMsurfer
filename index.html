<!DOCTYPE html>
<html>
<title>BIMsurfer V2 - Demo index</title>
<head>
	<script type="text/javascript" src="https://thisisanexperimentalserver.com/apps/bimserverjavascriptapi/js/bimserverapiwebsocket.js"></script>
	<script type="text/javascript" src="https://thisisanexperimentalserver.com/apps/bimserverjavascriptapi/js/bimserverclient.js"></script>
	<script type="text/javascript" src="https://thisisanexperimentalserver.com/apps/bimserverjavascriptapi/js/bimserverapipromise.js"></script>
	<script type="text/javascript" src="https://thisisanexperimentalserver.com/apps/bimserverjavascriptapi/js/ifc2x3tc1.js"></script>
	<script type="text/javascript" src="https://thisisanexperimentalserver.com/apps/bimserverjavascriptapi/js/ifc4.js"></script>
	<script type="text/javascript" src="https://thisisanexperimentalserver.com/apps/bimserverjavascriptapi/js/model.js"></script>
	<script type="text/javascript" src="https://thisisanexperimentalserver.com/apps/bimserverjavascriptapi/js/translations_en.js"></script>
</head>
<body>
<div id="bimserverdiv">
</div>
<h3>glTF</h3>
<a href="example_glTF.html">glTF</a>
<h3>Other</h3>
<a href="example_APIreference.html">API Reference</a>
<a href="example_testModel.html">Test Model</a>
<script>
document.addEventListener("DOMContentLoaded", function(event) {
	function loadFromBimserver(address, username, password) {
		var client = new BimServerClient(address);
		client.init(function(){
			var bimServerDiv = document.getElementById("bimserverdiv");
			var div = document.createElement("div");
			var h3 = document.createElement("h3");
			h3.textContent = "BIMserver (loaded from " + address + ")";
			div.appendChild(h3);
			var status = document.createElement("div");
			div.appendChild(status);
			var ul = document.createElement("ul");
			div.appendChild(ul);
			document.getElementById("bimserverdiv").appendChild(div);
			
			status.textContent = "Logging in...";
			client.login(username, password, function(){
				status.textContent = "Getting all projects...";
				client.call("ServiceInterface", "getAllProjects", {
					onlyTopLevel: true,
					onlyActive: true
				}, function(projects){
					projects.forEach(function(project){
						if (project.lastRevisionId != -1) {
							var li = document.createElement("li");
							var a = document.createElement("a");
							li.appendChild(a);
							a.textContent = project.name;
							a.setAttribute("href", "example_BIMServer.html?poid=" + project.oid + "&roid=" + project.lastRevisionId);
							ul.appendChild(li);
						}
					});
					status.textContent = "All projects loaded";
				});
			});
		});
	}
	
	loadFromBimserver("https://thisisanexperimentalserver.com", "bimsurfer@logic-labs.nl", "bimsurfer");
	loadFromBimserver("http://localhost:8080", "admin@bimserver.org", "admin");
});
</script>
</body>
</html>